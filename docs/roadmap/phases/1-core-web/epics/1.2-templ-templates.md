# Epic 1.2: Templ Templates

[← Back to Phase 1](../1-core-web.md) | [← Epic 1.1](./1.1-chi-router-setup.md)

## Overview

Integrate templ for type-safe, compile-time HTML templating in generated applications. This epic establishes the view layer directory structure, creates base layout templates, implements component patterns, and integrates templ generation into the build workflow. Templ provides Go's type safety and IDE support for HTML templates, catching errors at compile time rather than runtime.

## Goals

- Templ installed and configured in generated projects
- Directory structure for views (layouts, pages, components)
- Base layout template with common HTML structure
- Component composition patterns established
- Templ generation integrated into `make generate`
- Type-safe props and component interfaces
- CSP-compliant templates (no inline scripts/styles)
- Integration with Chi router for rendering

## Scope

### In Scope

- Templ CLI added to `tool` directive in go.mod
- View directory structure (`internal/http/views/`)
- Base layout template (`layouts/base.templ`)
- Example page templates (`pages/home.templ`, `pages/about.templ`)
- Component directory structure (`components/`)
- Helper functions for common patterns (conditional classes, safe URLs)
- Templ generation in Makefile (`make generate`)
- Handler integration (rendering templ components)
- Component props validation
- Dark mode class toggling patterns
- HTMX attribute helpers

### Out of Scope

- Templ-UI component library (Epic 1.5)
- TailwindCSS compilation (Epic 1.4)
- Alpine.js integration (Epic 1.4)
- Asset serving with hashfs (Epic 1.3)
- Full CRUD page examples (future epics)
- Client-side JavaScript beyond HTMX attributes
- Complex component libraries (Epic 1.5)

## Task Breakdown

The following tasks will become GitHub issues, ordered by dependency:

### Phase 1: Templ Foundation (Tasks 1-10)

1. Add templ to tool directive in generated go.mod
2. Create view directory structure
3. Add templ generation to Makefile
4. Create .templignore for excluding directories
5. Configure templ to generate to same directory
6. Create helper functions package (views/helpers.go)
7. Add HTMX attribute helpers
8. Create component props pattern documentation
9. Document templ syntax basics
10. Add templ LSP configuration for editors

### Phase 2: Base Layout (Tasks 11-20)

1. Create base layout template (layouts/base.templ)
2. Add meta tags component (components/meta.templ)
3. Create nav component (components/nav.templ)
4. Create footer component (components/footer.templ)
5. Add dark mode toggle component
6. Create flash message component
7. Add breadcrumb component
8. Create layout template with sidebar
9. Add CSP-compliant script loading
10. Create layout composition example

### Phase 3: Page Templates (Tasks 21-30)

1. Create home page template (pages/home.templ)
2. Create about page template (pages/about.templ)
3. Create error page templates
4. Add login page template (pages/login.templ)
5. Create registration page template (pages/register.templ)
6. Add user profile page template (pages/profile.templ)
7. Create dashboard page template (pages/dashboard.templ)
8. Add settings page template (pages/settings.templ)
9. Create list page template pattern
10. Add detail page template pattern

### Phase 4: Handler Integration (Tasks 31-40)

1. Create handler helper for rendering templ
2. Update home handler to use templ
3. Update about handler to use templ
4. Create error handler with templ
5. Add handler tests with templ rendering
6. Create template data builders
7. Add context helpers for templates
8. Create partial rendering pattern
9. Add template error handling
10. Document handler-to-template integration

### Phase 5: Advanced Patterns (Tasks 41-50)

1. Create form component library
2. Add form validation display
3. Create table component
4. Add modal component
5. Create card component library
6. Add badge component
7. Create avatar component
8. Add dropdown menu component
9. Create pagination component
10. Document component composition patterns

## Dependencies

### Prerequisites

- Phase 0 completed (project generation working)
- Epic 1.1 completed (Chi router and routes)
- Go 1.25+ (tool directive support)

### External Dependencies

- `github.com/a-h/templ` - Template engine
- Standard library: `html/template` (for SafeHTML helper)
- HTMX (loaded via CDN initially, Epic 1.4 for bundling)

### Blocks

- Epic 1.3 (HashFS Assets) - needs templates for asset URL helpers
- Epic 1.4 (Web Build Pipeline) - needs templates for TailwindCSS class scanning
- Epic 1.5 (Templ-UI Integration) - builds on component patterns

## Acceptance Criteria

### Templ Infrastructure

- [ ] Templ CLI installed in tool directive
- [ ] View directory structure created
- [ ] Templ generation runs with `make generate`
- [ ] Generated `*_templ.go` files colocated with `.templ` files
- [ ] `.templignore` excludes vendor and generated directories

### Templates & Components

- [ ] Base layout template functional
- [ ] Meta tags, nav, footer components working
- [ ] Home, about, error page templates created
- [ ] Login, registration templates with forms
- [ ] Component props pattern documented
- [ ] Helper functions available (ClassNames, SafeHTML, etc.)
- [ ] HTMX attribute helpers working

### Handler Integration

- [ ] Handler helper renders templ components
- [ ] Home and about handlers use templ
- [ ] Error handlers render error pages
- [ ] Handler tests verify template rendering
- [ ] Context helpers extract common data

### Documentation

- [ ] Templ syntax guide in README
- [ ] Component composition patterns documented
- [ ] Editor setup instructions provided
- [ ] Props pattern documented with examples

## Next Epic

[Epic 1.3: HashFS Assets →](./1.3-hashfs-assets.md)
